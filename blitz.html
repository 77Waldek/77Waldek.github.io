<!DOCTYPE html>
<html lang="pl">
<head>
  <title>Załoga Cwanych Lisów</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: #0a0a0a url('tlo-blitz.jpg') center/cover fixed no-repeat;
      color: #f0f0ff;
      font-family: Arial, Helvetica, sans-serif;
    }

    .clan-header {
      text-align: center;
      padding: 80px 20px 140px;
      background: linear-gradient(to bottom, rgba(0,0,0,.75), transparent);
    }

    .neon-title {
      font-size: 4.5rem;
      color: #ff7700;
      letter-spacing: 5px;
      text-shadow: 0 0 15px #ff7700, 0 0 40px #ffaa00;
      animation: pulse 3s infinite alternate;
    }

    @keyframes pulse {
      from { opacity: .85; }
      to { opacity: 1; }
    }

    .container {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: -100px;
      padding: 20px;
      flex-wrap: wrap;
    }

    .box {
      background: rgba(20,20,20,.95);
      border-radius: 14px;
      padding: 30px;
      box-shadow: 0 0 25px rgba(255,120,0,.6);
      border: 1px solid rgba(255,140,0,.45);
      max-width: 520px;
      width: 100%;
    }

    h2 {
      color: #ff8800;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 16px;
    }

    td {
      padding: 10px 6px;
      border-bottom: 1px solid #444;
    }

    td:first-child {
      font-weight: bold;
      color: #ffcc99;
    }

    tr:last-child td {
      border-bottom: none;
    }

    .wn8 {
      font-weight: bold;
      text-align: right;
    }

    .loading {
      color: #aaa;
    }

    @media (max-width: 600px) {
      .neon-title { font-size: 3rem; }
    }
  </style>
</head>

<body>

<div class="clan-header">
  <h1 class="neon-title">Załoga Cwanych Lisów</h1>
</div>

<div class="container">
  <div class="box">
    <h2>Członkowie klanu (WN8 LIVE)</h2>
    <table id="playersTable"></table>
  </div>
</div>

<script>
/* ===== MAPOWANIE NICKÓW ===== */
const players = [
  { display: "77Waldek", blitz: "CEWaldek", role: "Lider" },
  { display: "HusarGP", blitz: "Husar_2020", role: "Zastępca" },
  { display: "NatanCard", blitz: "NatanCard", role: "Honorowy Lis" },
  { display: "Sawatatrik", blitz: "Sawatatrik", role: "PanzerFox" },
  { display: "PREZEStoJA", blitz: "PREZEStoJA", role: "PanzerFox" },
  { display: "Kgorska373", blitz: "Kgorska373", role: "PanzerFox" },
  { display: "Toblet_Sigma", blitz: "Toblet_Sigma", role: "PanzerFox" }
];

const table = document.getElementById("playersTable");

/* ===== KOLORY WN8 ===== */
function wn8Color(wn8) {
  if (wn8 < 900) return "#999";
  if (wn8 < 1400) return "#4caf50";
  if (wn8 < 2000) return "#2196f3";
  if (wn8 < 2600) return "#9c27b0";
  return "#ff9800";
}

/* ===== RYSUJ TABELĘ ===== */
players.forEach(p => {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td>${p.display}</td>
    <td>${p.role}</td>
    <td class="wn8 loading" id="wn8-${p.blitz}">⏳</td>
  `;
  table.appendChild(row);
});

/* ===== POBIERANIE WN8 ===== */
async function loadWN8(player) {
  const el = document.getElementById(`wn8-${player.blitz}`);

  try {
    const res = await fetch(
      `https://api.allorigins.win/raw?url=https://www.blitzstars.com/player/eu/${player.blitz}`
    );
    const text = await res.text();

    const match = text.match(/WN8[^0-9]*([0-9]+)/i);
    if (!match) throw "Brak WN8";

    const wn8 = parseInt(match[1]);
    el.textContent = wn8;
    el.style.color = wn8Color(wn8);
    el.classList.remove("loading");

  } catch {
    el.textContent = "—";
    el.style.color = "#666";
  }
}

/* ===== START + AUTO REFRESH ===== */
function refreshAll() {
  players.forEach(loadWN8);
}

refreshAll();
setInterval(refreshAll, 300000); // co 5 minut
</script>

</body>
</html>
